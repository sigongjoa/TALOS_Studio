## 테스트 정의: 월아천충 VFX 생성 파이프라인

**1. 전체 목표**
LLM 및 에이전트 오케스트레이션에 의한 초기 프롬프트 해석부터 유체 시뮬레이션, Blender 시각화, 최종 GIF 출력에 이르기까지 월아천충 VFX 생성 파이프라인의 엔드투엔드 기능을 검증하고, 생성된 VFX가 "월아천충" 미학에 부합하는지 확인합니다.

**2. 범위**
이 테스트는 시스템의 다음 구성 요소를 다룹니다.
*   **LLM (대규모 언어 모델):** VFX 생성을 위한 사용자 프롬프트 해석 능력.
*   **에이전트 (피드백, 렌더링, 시뮬레이션, 스타일):** 각 작업의 올바른 오케스트레이션 및 실행.
*   **유체 시뮬레이션:** 정확한 Navier-Stokes 유체 데이터 생성.
*   **Blender 시각화 (`blender_fluid_visualizer.py`):** 유체 데이터의 올바른 해석 및 Blender 장면에서 스타일화된 월아천충 VFX 생성.
*   **GIF 생성:** Blender 애니메이션을 고품질 GIF로 변환.
*   **결과 로깅:** 프로세스의 각 단계에 대한 포괄적인 로그 생성.

**3. 테스트 환경**
*   Blender가 설치되어 있고 명령줄을 통해 액세스 가능해야 합니다.
*   모든 프로젝트 종속성이 설치된 Python 환경.
*   LLM 및 에이전트 서비스에 대한 액세스.
*   유체 데이터, Blender 파일 및 GIF 출력을 위한 충분한 디스크 공간.

**4. 테스트 케이스**

**테스트 케이스 1: 기본 월아천충 생성**
*   **입력 프롬프트:** "월아천충과 같은 유체 VFX를 생성해줘."
*   **예상 에이전트 흐름:**
    1.  LLM이 프롬프트를 해석하고 시뮬레이션 에이전트를 트리거합니다.
    2.  시뮬레이션 에이전트가 Navier-Stokes 시뮬레이션을 실행하고 `fluid_data_XXXX.npz` 파일을 출력합니다.
    3.  LLM이 스타일 에이전트를 트리거하여 월아천충에 대한 `viz_params`를 결정합니다.
    4.  LLM이 `fluid_data_XXXX.npz` 및 `viz_params`를 사용하여 렌더 에이전트를 트리거합니다.
    5.  렌더 에이전트가 `blender_fluid_visualizer.py`를 실행하여 `.blend` 파일을 생성합니다.
    6.  렌더 에이전트가 `.blend` 애니메이션을 GIF로 변환합니다.

**테스트 케이스 2: 매개변수화된 월아천충 생성 (예: 색상 변경)**
*   **입력 프롬프트:** "빨간색 월아천충 VFX를 생성해줘."
*   **예상 에이전트 흐름:** 테스트 케이스 1과 유사하지만, 스타일 에이전트가 재료에 대한 빨간색 기본 색상을 포함하는 `viz_params`를 생성해야 합니다.

**테스트 케이스 3: 소멸 제어**
*   **입력 프롬프트:** "빨리 소멸되는 월아천충 VFX를 생성해줘."
*   **예상 에이전트 흐름:** 테스트 케이스 1과 유사하지만, 스타일 에이전트가 더 짧은 소멸 기간을 위해 구성된 `animation_params`를 포함하는 `viz_params`를 생성해야 합니다.

**5. 실행 단계**
1.  지정된 사용자 프롬프트로 메인 파이프라인 스크립트 (예: `src/main.py`)를 시작합니다.
    *   예시: `python src/main.py "월아천충과 같은 유체 VFX를 생성해줘."`
2.  콘솔 출력을 모니터링하여 실행 진행 상황 및 에이전트 상호 작용을 확인합니다.
3.  파이프라인이 완료될 때까지 기다립니다.

**6. 예상 결과 / 성공 기준**

A test is considered successful if **all** of the following conditions are met:

*   **프로세스 실행:**
    *   LLM이 프롬프트를 성공적으로 처리합니다.
    *   시뮬레이션 에이전트가 성공적으로 실행되고 `workspace/outputs/fluid_data/`에 `fluid_data_XXXX.npz` 파일을 생성합니다.
    *   스타일 에이전트가 요청된 VFX에 적합한 `viz_params` ( `mesh_params`, `material_params`, `freestyle_params`, `animation_params` 포함)를 성공적으로 생성합니다.
    *   렌더 에이전트가 오류 없이 `blender_fluid_visualizer.py`를 성공적으로 실행합니다.
    *   렌더 에이전트가 Blender 애니메이션을 GIF로 성공적으로 변환합니다.

*   **결과 로그:**
    *   전체 파이프라인 실행에 대한 포괄적인 로그 파일이 생성되며 다음을 자세히 설명합니다.
        *   LLM 프롬프트 해석.
        *   에이전트 작업 및 매개변수.
        *   시뮬레이션 매개변수 및 출력 경로.
        *   Blender 스크립트 실행 세부 정보 (예: 사용된 `viz_params`).
        *   GIF 생성 명령 및 출력 경로.
    *   로그는 지정된 `logs/` 디렉토리 (예: `local_test_outputs/logs/`)에 저장되어야 합니다.

*   **Blender 출력:**
    *   `workspace/outputs/`에 `.blend` 파일이 생성됩니다 (예: `workspace/outputs/getsuga_tenshou_vfx.blend`).
    *   Blender에서 이 `.blend` 파일을 열면 `getsuga_tenshou_vfx.md`에 정의된 시각적 특성 (예: 초승달/파도 모양, 스타일화된 음영, 빛나는 가장자리, 명확한 윤곽선)을 준수하는 스타일화된 월아천충 VFX가 포함된 애니메이션 장면이 표시되어야 합니다.

*   **GIF 파일:**
    *   `workspace/outputs/`에 GIF 파일이 생성됩니다 (예: `workspace/outputs/getsuga_tenshou_vfx.gif`).
    *   GIF는 `.blend` 파일의 애니메이션 월아천충 VFX를 시각적으로 나타내야 합니다.
    *   GIF는 합리적인 품질과 프레임 속도를 가져야 하며, 유체 움직임과 스타일화된 효과를 명확하게 보여주어야 합니다.

**7. 검증**
*   **로그 검토:** 생성된 로그 파일에서 오류, 경고 또는 예상치 못한 동작이 있는지 검사합니다. 예상되는 모든 에이전트 상호 작용 및 프로세스 실행이 기록되었는지 확인합니다.
*   **Blender 파일 검사:** Blender에서 생성된 `.blend` 파일을 열어 메시, 재료, Freestyle 설정 및 애니메이션을 시각적으로 검사합니다. VFX가 "월아천충" 미학 및 스타일 에이전트가 지정한 매개변수와 일치하는지 확인합니다.
*   **GIF 재생:** 생성된 GIF를 재생하여 애니메이션, 시각적 품질 및 전반적인 효과를 확인합니다.
