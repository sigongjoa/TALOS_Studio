# 프론트엔드 구축 기획 (Frontend Development Plan)

## 1. 목표 (Goal)

기존 Python 기반의 유체 시뮬레이션 VFX 파이프라인을 위한 사용자 친화적인 웹 기반 인터페이스를 구축하여, 사용자가 코드를 직접 수정하지 않고도 파라미터를 쉽게 조작하고, 시뮬레이션 진행 상황을 실시간으로 확인하며, 최종 렌더링 결과를 웹에서 바로 확인할 수 있도록 한다.

## 2. 기술 스택 (Technology Stack)

*   **백엔드 (Backend API Server):**
    *   **언어:** Python
    *   **프레임워크:** Flask (경량성과 유연성을 고려)
    *   **주요 라이브러리:** `subprocess` (파이프라인 실행), `Flask-CORS` (CORS 처리), `Flask-SocketIO` (실시간 로그 전송)
*   **프론트엔드 (Frontend Web UI):**
    *   **언어:** JavaScript (ES6+)
    *   **프레임워크:** React (컴포넌트 기반 개발 및 활발한 생태계 고려)
    *   **주요 라이브러리:** `axios` (API 통신), `socket.io-client` (실시간 통신), UI 라이브러리 (예: Material-UI 또는 Ant Design - 추후 결정)

## 3. 주요 기능 (Key Features)

### 3.1. 파라미터 조작 (Parameter Manipulation)

*   **입력 폼:** 시뮬레이션 및 시각화 파라미터를 입력하고 수정할 수 있는 직관적인 웹 폼 제공.
    *   **시뮬레이션 파라미터 예시:**
        *   `grid_resolution`: `(101, 101)` (텍스트 박스 또는 드롭다운)
        *   `time_steps`: `30` (슬라이더 또는 숫자 입력 박스)
        *   `viscosity`: `0.02` (슬라이더 또는 숫자 입력 박스)
        *   `initial_shape_type`: `vortex`, `crescent`, `circle_burst` (드롭다운)
        *   `initial_shape_position`: `(1.0, 1.0)` (두 개의 숫자 입력 박스)
        *   `initial_shape_size`: `0.4` (슬라이더 또는 숫자 입력 박스)
        *   `vortex_strength`: `1.2` (슬라이더 또는 숫자 입력 박스)
        *   `source_strength`: `2.0` (슬라이더 또는 숫자 입력 박스)
    *   **시각화 파라미터 예시:**
        *   `arrow_color`: `(0.0, 0.0, 0.8)` (컬러 피커 또는 RGB 숫자 입력 박스)
        *   `emission_strength`: `50.0` (슬라이더 또는 숫자 입력 박스)
        *   `transparency_alpha`: `0.1` (슬라이더 또는 숫자 입력 박스)
*   **기본값/유효성 검사:** 각 파라미터에 대한 기본값 제공 및 클라이언트/서버 측 유효성 검사 (예: 숫자 범위, 문자열 형식) 구현.

### 3.2. 파이프라인 실행 및 진행 상황 모니터링 (Execution & Progress Monitoring)

*   **실행/중지 버튼:** 파이프라인 실행을 시작하고, 필요시 중지할 수 있는 버튼 제공.
*   **실시간 로그:** 백엔드에서 파이프라인(`run_full_pipeline.py`) 실행 시 발생하는 터미널 출력(로그)을 프론트엔드 웹 페이지에 실시간으로 스트리밍하여 표시.
*   **진행률 표시:**
    *   **단계별 상태:** 시뮬레이션, Blender 씬 생성, 렌더링 등 파이프라인의 현재 단계를 명확히 표시.
    *   **렌더링 진행률 (%):** 렌더링 단계에서는 총 프레임 수 대비 현재 렌더링된 프레임 수 또는 Blender 로그에서 추출한 샘플 진행률(%)을 표시하여 세분화된 진행 상황 제공.
*   **상태 표시:** 파이프라인의 현재 상태(예: "시뮬레이션 중", "렌더링 중", "완료", "오류 발생")를 사용자에게 시각적으로 피드백.

### 3.3. 결과 확인 (Result Viewing)

*   **이미지 갤러리:** 렌더링이 완료된 PNG 프레임 이미지들을 웹 페이지에서 순서대로 표시하고 탐색할 수 있는 갤러리/슬라이더 기능.
*   **비디오 합성:** 렌더링된 PNG 프레임들을 서버 측에서 MP4 또는 WebM 형식의 비디오 파일로 합성하여 제공. (YouTube 업로드 등 실제 활용 고려)
*   **다운로드:** 개별 이미지, 전체 프레임 시퀀스(압축 파일), 또는 합성된 비디오 파일을 다운로드할 수 있는 기능.

## 3.4. 보안 및 에러 처리 (Security & Error Handling)

*   **입력값 정제 (Sanitization):** 사용자 입력값이 `subprocess`로 직접 전달되기 전에, 잠재적인 보안 이슈(예: 명령 주입 공격)를 방지하기 위해 모든 파라미터에 대한 철저한 검증 및 정제 로직을 백엔드에서 구현.
*   **API 에러 처리:**
    *   시뮬레이션 또는 렌더링 실패 시, 백엔드에서 발생한 오류 메시지를 프론트엔드로 명확하게 전달하여 사용자에게 알림.
    *   프론트엔드에서는 사용자 친화적인 오류 메시지를 표시하고, 필요한 경우 디버깅을 위한 상세 로그를 제공.
*   **파이프라인 중단:** 백엔드에서 `subprocess`를 안전하게 종료하여 파이프라인 실행을 중단하는 기능 구현.

## 4. 아키텍처 개요 (Architecture Overview)

```
+-------------------+       +-------------------+       +-------------------+
|   Frontend (React)  |       |   Backend (Flask)   |       |   Python Pipeline   |
| (Web Browser)     | <---> | (API Server)      | <---> | (Existing Scripts)  |
+-------------------+       +-------------------+-------+-------------------+
      ^     ^                     ^                     ^
      |     |                     |                     |
      |     +---------------------+ (HTTP/WebSocket)    |
      |                           |                     |
      +---------------------------+ (Real-time Logs)    |
                                                        |
                                                        +-------------------+
                                                              (File System)
```

*   **프론트엔드:** 사용자 인터페이스를 제공하며, 백엔드 API 서버와 HTTP 요청(파라미터 전송, 실행 명령) 및 WebSocket(실시간 로그 수신)을 통해 통신합니다.
*   **백엔드:** 프론트엔드의 요청을 받아 기존 Python 파이프라인 스크립트(`run_full_pipeline.py`)를 `subprocess` 모듈을 통해 실행합니다. 파이프라인의 표준 출력(stdout)을 캡처하여 WebSocket을 통해 프론트엔드로 실시간 전송합니다. 또한, 렌더링된 이미지 파일들을 프론트엔드에 제공하기 위해 파일 시스템에 접근합니다.
*   **Python 파이프라인:** 기존의 시뮬레이션, Blender 씬 생성, 렌더링 로직을 담당합니다. 렌더링된 이미지 파일들을 파일 시스템에 저장합니다.

## 5. 개발 단계 (Development Phases)

1.  **환경 설정:**
    *   Flask 백엔드 및 React 프론트엔드 프로젝트 초기 설정.
    *   CORS 및 SocketIO 기본 설정.
2.  **백엔드 API 구현:**
    *   파라미터 수신 및 파이프라인 실행 API 엔드포인트 (`/run_pipeline`).
    *   `run_full_pipeline.py`의 출력을 실시간으로 캡처하여 SocketIO로 전송하는 로직 구현.
3.  **프론트엔드 UI 구현:**
    *   파라미터 입력 폼 컴포넌트.
    *   실행/중지 버튼.
    *   실시간 로그 표시 컴포넌트.
    *   백엔드 API 연동 (axios, socket.io-client).
4.  **결과 뷰어 구현:**
    *   렌더링된 이미지들을 표시하는 갤러리 컴포넌트.
    *   비디오 합성 기능 (FFmpeg 연동).
    *   (선택 사항) 이미지/비디오 다운로드 기능.
5.  **배포 (선택 사항):** Docker를 이용한 컨테이너화 및 배포 스크립트 작성.

## 6. 승인 (Approval)

위 기획에 대해 검토해주시고, 승인해주시면 다음 단계인 명세 작성 및 구현을 진행하겠습니다.