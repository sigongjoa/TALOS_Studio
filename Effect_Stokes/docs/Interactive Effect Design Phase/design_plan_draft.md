# 인터랙티브 이펙트 디자인 페이즈 기획서 초안

## 1. 페이즈 명칭
인터랙티브 이펙트 디자인 페이즈 (Interactive Effect Design Phase)

## 2. 목표
LLM(Large Language Model)의 파라미터 제안 기능을 활용하고, 시각적 미리보기 및 사용자 피드백 루프를 통해 유체 이펙트 디자인 과정을 혁신합니다. 이를 통해 사용자가 원하는 이펙트를 효율적으로 탐색하고 정제하며, 불필요한 전체 파이프라인 실행을 최소화하여 개발 시간과 자원 소모를 줄이는 것을 목표로 합니다.

## 3. 주요 기능

### 3.1. LLM 기반 파라미터 제안
*   사용자의 자연어 이펙트 설명(예: "소용돌이치는 푸른 액체")을 기반으로 LLM이 시뮬레이션 및 시각화 파라미터 초안을 생성합니다.
*   생성된 파라미터는 프론트엔드 UI에 표시되어 사용자가 즉시 확인할 수 있도록 합니다.

### 3.2. 사용자 파라미터 검토 및 수정
*   LLM이 제안한 파라미터들을 UI에서 직관적으로 확인하고 개별적으로 수정할 수 있는 기능을 제공합니다.
*   각 파라미터의 유효 범위 및 타입에 대한 가이드라인을 UI에 표시하여 사용자의 수정을 돕습니다.

### 3.3. 실시간 미리보기/샘플링 메커니즘
*   사용자가 파라미터를 수정하거나 LLM 제안을 수락한 후, 전체 파이프라인을 실행하기 전에 이펙트의 짧은 미리보기(예: 몇 프레임, 저해상도 렌더링)를 빠르게 생성하여 시각적 피드백을 제공합니다.
*   미리보기는 시뮬레이션의 핵심적인 특성을 빠르게 파악할 수 있도록 최적화된 속도로 제공됩니다.

### 3.4. 반복적인 피드백 루프
*   미리보기 결과를 바탕으로 사용자가 파라미터를 다시 수정하고, 새로운 미리보기를 요청하는 반복적인 디자인 사이클을 지원합니다.
*   사용자가 만족할 때까지 이 과정을 반복할 수 있도록 합니다.

### 3.5. (선택적 확장) 함수 기반 시간 의존적 파라미터
*   향후 확장 기능으로, 특정 파라미터(예: 소용돌이 강도, 크기)가 시뮬레이션 시간 축에 따라 변화하는 함수 형태로 정의될 수 있도록 지원합니다.
*   이를 통해 더욱 동적이고 복잡한 이펙트의 디자인이 가능해집니다. (이 기능은 본 페이즈의 초기 구현 이후 고려)

## 4. 고수준 아키텍처 변경 사항

### 4.1. 백엔드 API (`backend/app.py`)
*   **`/api/get_llm_inferred_params`**: LLM이 추론한 파라미터를 프론트엔드로 반환하는 기존 엔드포인트 유지 및 개선.
*   **`/api/run_preview` (신규)**: 현재 파라미터 세트를 기반으로 짧은 미리보기 시뮬레이션 및 렌더링을 실행하고 결과를 반환하는 엔드포인트.
*   **`/api/run_pipeline`**: 사용자가 확정한 파라미터 세트를 받아 전체 파이프라인을 실행하는 엔드포인트.

### 4.2. 시뮬레이션 및 렌더링 로직 (`src/` 디렉토리)
*   **`run_full_pipeline.py`**: "미리보기 모드"를 지원하도록 수정. 미리보기 요청 시, `navier_stokes_test.py` 및 Blender 시각화 스크립트를 제한된 설정(예: 적은 `time_steps`, 낮은 렌더 샘플)으로 실행하도록 제어.
*   **`navier_stokes_test.py`**: 미리보기 모드에서 더 적은 시간 단계만 시뮬레이션하도록 파라미터 처리 로직 개선.
*   **Blender 시각화 스크립트**: 미리보기 모드에서 더 적은 프레임만 렌더링하거나 낮은 해상도/샘플 수로 렌더링하도록 파라미터 처리 로직 개선.

### 4.3. 프론트엔드 (React 앱)
*   **파라미터 UI**: LLM 제안 파라미터를 표시하고 사용자가 수정할 수 있는 동적인 입력 필드 및 컨트롤 구현.
*   **미리보기 트리거**: "미리보기" 버튼 추가.
*   **미리보기 결과 표시**: 미리보기 시뮬레이션/렌더링 결과를 표시할 수 있는 영역(예: 비디오 플레이어, 이미지 시퀀스 뷰어) 구현.
*   **전체 파이프라인 실행**: "전체 파이프라인 실행" 버튼을 통해 최종 파라미터로 전체 프로세스 시작.

## 5. 기대 효과
*   **이펙트 품질 향상**: 사용자의 직접적인 개입으로 LLM의 한계를 보완하고, 원하는 이펙트를 정확하게 구현.
*   **개발 시간 단축**: 불필요한 전체 파이프라인 실행을 줄여 이펙트 디자인 및 개발에 소요되는 시간을 크게 단축.
*   **사용자 경험 개선**: 즉각적인 시각적 피드백과 반복적인 디자인 기회를 제공하여 사용자 만족도 증대.
*   **자원 효율성 증대**: 컴퓨팅 자원(CPU/GPU) 사용을 최적화하여 비용 절감 효과.

---
