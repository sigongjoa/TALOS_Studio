# 📑 NarrationAgent(마님) 모듈 정의 및 명세서

## 1. 정의
**NarrationAgent(마님)**은 Effect Stokes 시스템 내에서 생성된 수학/물리 공식을 **스토리텔링 기반 내레이션**으로 변환하고, 이를 음성과 자막으로 출력하는 모듈이다. 핵심 목표는 **수식에 생명을 불어넣어 시청자가 직관적으로 이해할 수 있게 하는 것**이다.

---

## 2. 입력
- **수식/파라미터**: StyleAgent 또는 Orchestrator로부터 전달됨
- **보조 텍스트 설명**: 사용자가 제공하거나 자동 생성된 설명
- **타임라인 정보(옵션)**: 자막 싱크를 위한 시간 데이터

---

## 3. 출력
- **내레이션 텍스트** (문자열)
- **TTS 오디오 파일** (mp3/wav)
- **자막 파일** (SRT)

---

## 4. 주요 기능
1. **스크립트 생성**
   - LLM을 호출하여 수식을 해설하는 짧고 직관적인 내레이션 생성
   - 톤: 지혜로운 해설자, 교육+밈 스타일
   - 예: “이건 단순한 주기 함수일세. 푸리에 변환을 하면 패턴이 훤히 드러난다네.”

2. **TTS 변환**
   - 생성된 대본을 음성으로 변환
   - 다양한 톤/음색 옵션 지원 (흥분/차분/코믹 등)

3. **자막 생성**
   - 내레이션 텍스트를 시간 정보와 함께 SRT 파일로 변환
   - 자동 타임코드 부여 또는 외부 타임라인 입력 지원

### 4.1 기술적 고려사항

*   **LLM 프롬프트 최적화**: 마님의 독특한 톤(지혜로운 해설자, 교육+밈)을 일관되게 유지하기 위해 LLM 프롬프트를 지속적으로 최적화하고, 페르소나 가이드라인을 명확히 합니다.
*   **수식 해석의 정확성**: StyleAgent로부터 전달받은 수식을 정확하게 이해하고 해설에 반영하도록 LLM의 수식 이해 능력을 강화합니다. 필요한 경우, 수식 파싱 및 검증 모듈과 연동하여 오해석을 방지합니다.
*   **모호한 입력 처리**: StyleAgent에서 넘어온 수식이나 파라미터가 모호하거나 불완전할 경우, NarrationAgent는 이를 인지하고 일반적인 설명으로 대체하거나, 추가 정보 요청을 위한 플래그를 설정할 수 있도록 설계합니다.
*   **콘텐츠 필터링**: 생성된 내레이션이 부적절하거나 시스템의 의도와 다른 내용을 포함하지 않도록 LLM 출력에 대한 필터링 및 검토 메커니즘을 마련합니다.

---

## 5. 내부 구성
- **ScriptGenerator 서브모듈**: 수식을 내레이션 텍스트로 변환
- **TTS 서브모듈**: 텍스트 → 음성 변환
- **Subtitle 서브모듈**: 텍스트 → 자막 파일 변환

---

## 6. Orchestrator와의 연동
- Orchestrator가 NarrationAgent를 호출하여 결과물을 받음
- RenderAgent 단계에서:
  - 오디오 → 영상 배경 내레이션으로 삽입
  - 자막 → 영상 하단 오버레이

---

## 7. 기대 효과
- **수식 이해 강화**: 단순 시각화가 아니라, 해설을 통해 직관적 학습 가능
- **콘텐츠 차별화**: 밈/교육적 내레이션과 VFX 결합으로 독창적 콘텐츠 제공
- **확장성**: 애니, 과학, 게임 등 다양한 장르에 적용 가능

---

✅ 결론: NarrationAgent는 **“수식을 설명하는 해설자”**로서, Effect Stokes 시스템에서 VFX와 학습을 연결하는 핵심 모듈이다.